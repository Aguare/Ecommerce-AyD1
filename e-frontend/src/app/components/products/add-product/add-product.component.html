<div class="container card mt-6 p-3">
  <h2 class="title is-4">Agregar Producto</h2>

  <div class="columns">
    <div class="column is-half">
      <form [formGroup]="productForm" (ngSubmit)="submitForm()">
        <div class="field">
          <label class="label">Nombre</label>
          <div class="control">
            <input
              formControlName="name"
              class="input"
              type="text"
              placeholder="Nombre del producto"
            />
          </div>
        </div>

        <div class="field">
          <label class="label">Descripción</label>
          <div class="control">
            <textarea
              formControlName="description"
              class="textarea"
              placeholder="Descripción del producto"
            ></textarea>
          </div>
        </div>

        <div class="field">
          <label class="label">Precio</label>
          <div class="control">
            <input
              formControlName="price"
              class="input"
              type="number"
              placeholder="Precio del producto"
            />
          </div>
        </div>

        <div class="field">
          <label class="label">Categoría</label>
          <div class="control">
            <div class="select">
              <select formControlName="category">
                <option value="">-- Seleccione una Opcion --</option>
                <option *ngFor="let category of categories" [value]="category.name">
                  {{ category.name }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <div class="field">
          <label class="label">Marca</label>
          <div class="control">
            <div class="select">
              <select formControlName="brand">
                <option value="">-- Seleccione una Opcion --</option>
                <option *ngFor="let brand of brands" [value]="brand">
                  {{ brand }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <div class="field mt-3">
          <label class="label">Subir Imágenes</label>
          <div class="control">
            <div class="file has-name">
              <label class="file-label">
                <input
                  class="file-input"
                  type="file"
                  accept="image/*"
                  (change)="onFileSelected($event)"
                  multiple
                />
                <span class="file-cta">
                  <span class="file-icon">
                    <i class="fas fa-upload"></i>
                  </span>
                  <span class="file-label">Selecciona una Imagen</span>
                </span>
              </label>
            </div>
          </div>
        </div>

        <div class="field mt-3">
          <h4>Atributos</h4>

          <div class="control">
            <button
              type="button"
              class="button is-primary is-small"
              (click)="addAttribute()"
            >
              Agregar Atributo
            </button>
          </div>

          <div formArrayName="attributes" class="mt-4 p-3">
            <div
              *ngFor="let attribute of attributes.controls; let i = index"
              [formGroupName]="i"
              class="field is-grouped is-grouped-multiline"
            >
              <div class="control is-expanded">
                <input
                  formControlName="attributeName"
                  class="input"
                  placeholder="Nombre del atributo"
                />
              </div>
              <div class="control is-expanded">
                <input
                  formControlName="attributeValue"
                  class="input"
                  placeholder="Descripción del atributo"
                />
              </div>
              <div class="control">
                <button
                  type="button"
                  class="button is-danger is-light mb-3"
                  (click)="removeAttribute(i)"
                >
                  Eliminar
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="field is-grouped mt-4">
          <div class="control">
            <button
              [disabled]="productForm.invalid"
              class="button is-primary"
              type="submit"
            >
              Guardar Producto
            </button>
          </div>
          <div class="control">
            <button class="button is-light" type="reset">Cancelar</button>
          </div>
        </div>
      </form>
    </div>

    <div class="column is-half">
        <h4 class="title is-5">Previsualización de Imágenes</h4>
        <div class="columns is-multiline">
          <div *ngFor="let image of imagePreviews; let i = index" class="column is-one-quarter">
            <figure class="image is-100x100">
              <img [src]="image" alt="Preview Image" class="image-preview" />
            </figure>
            <!-- Botón para eliminar la imagen -->
            <button class="button is-danger is-small mt-2" (click)="removeImage(i)">
              X
            </button>
          </div>
        </div>
      </div>
  </div>
</div>
